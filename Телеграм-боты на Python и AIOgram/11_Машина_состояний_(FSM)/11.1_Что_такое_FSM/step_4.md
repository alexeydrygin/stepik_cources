## Фильтры состояний в хэндлерах
-----------------------------

Давайте немного подробнее остановимся на типовых ситуациях, которые могут возникнуть при работе с FSM.

1.  **Хэндлер должен срабатывать в любых состояниях**
    
    Это поведение "по умолчанию" для всех хэндлеров. То есть если вы не укажете среди фильтров для хэндлера никаких фильтров состояний - хэндлер будет доступен в любом состоянии, включая состояние "по умолчанию".
    
2.  **Хэндлер должен срабатывать в любых состояниях, кроме состояния "по умолчанию"**
    
    То есть мы хотим, чтобы хэндлер работал внутри машины состояний, но не работал вне ее. Такое поведение достигается через инверсию дефолтного состояния, то есть мы говорим хэндлеру работать НЕ в дефолтном состоянии - `~StateFilter(default_state)`
    
3.  **Хэндлер должен срабатывать в конкретном состоянии**
    
    Нужно указать в качестве фильтра это конкретное состояние - `StateFilter(<конкретное_состояние>)`
    
4.  **Хэндлер должен срабатывать в некоторых состояниях**
    
    Нужно указать эти конкретные состояния - `StateFilter(<конкретное_состояние_1>, <конкретное_состояние_2>, <конкретное_состояние_3>)`
    
5.  **Хэндлер должен срабатывать в любых состояниях, кроме некоторых**
    
    Используем инверсию - `~StateFilter(<конкретное_состояние_1>, <конкретное_состояние_2>, <конкретное_состояние_3>)`
    
6.  **Хэндлер должен срабатывать в состоянии по умолчанию, а в любых других состояниях нет**
    
    Указываем в качестве фильтра `StateFilter(default_state)`
    

**Примечание.** Исходя из этого, нужно помнить, что если вы используете в вашем боте машину состояний и хотите, чтобы некоторые команды были доступны только в состоянии по умолчанию (например, команда /start) - нужно явно указывать дополнительный фильтр `StateFilter(default_state)`, иначе команда будет доступна вообще в любом состоянии.