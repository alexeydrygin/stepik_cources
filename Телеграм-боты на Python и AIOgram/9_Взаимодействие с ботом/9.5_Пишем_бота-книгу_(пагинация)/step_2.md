## Постановка задачи
-----------------

### Что?

Бот-книга

### Чтобы что?

Чтобы можно было читать книгу прямо в телеграм-боте и попрактиковаться в работе с инлайн-кнопками

### Что бот должен уметь?

1.  Загружать страницы книги из хранилища и присылать их в чат в виде сообщений с кнопками
2.  Сохранять страницу, на которой остановился пользователь и загружать книгу на этом месте
3.  Переходить в начало книги

### Дополнительный функционал

1.  Сохранять закладки - страницы книги, которые пользователь пожелал сохранить
2.  Редактировать закладки (удалять ненужные)

### Описание взаимодействия с ботом

1.  Пользователь отправляет команду /start боту (или стартует его, найдя в поиске)
2.  Бот приветствует пользователя, сообщает, что пользователь может прочитать книгу прямо в чате с ботом, а также предлагает пользователю посмотреть список доступных команд, отправив команду /help
    
    ![](https://ucarecdn.com/8a317e9e-7854-4ffb-8c73-428de4a66702/-/preview/-/enhance/83/)
    
3.  На этом этапе пользователь может совершить 5 действий:
    1.  Отправить в чат команду /help
    2.  Отправить в чат команду /beginning
    3.  Отправить в чат команду /continue
    4.  Отправить в чат команду /bookmarks
    5.  Отправить в чат любое другое сообщение
4.  Пользователь отправляет в чат команду /help:
    1.  Бот присылает пользователю список доступных команд, сообщает о том, что можно сохранять страницы книги в закладки и желает приятного чтения
        
        ![](https://ucarecdn.com/4559c3fa-62f1-4c5b-9725-1e1b0bcfd2a2/-/preview/-/enhance/88/)
        
5.  Пользователь отправляет в чат команду /beginning:
    1.  Бот отправляет в чат первую страницу книги и 3 инлайн-кнопки (назад, текущий номер страницы и вперед)
        
        ![](https://ucarecdn.com/a85cb58c-580c-433b-a8a1-793aaf56e587/-/preview/-/enhance/87/)
        
    2.  Соответственно, при взаимодействии с сообщением-книгой пользователь может:
        1.  Нажать на кнопку "Вперед" и тогда бот загрузит следующую страницу книги, если текущая страница не последняя. Номер текущей страницы на кнопке увеличится на 1. А если текущая страница последняя в книге, то ничего не изменится.
        2.  Нажать на кнопку с текущим номером страницы и тогда бот сохранит эту страницу в закладки, сообщив пользователю об этом
        3.  Нажать на кнопку "Назад" и тогда бот загрузит предыдущую страницу книги, если текущая страница не первая. Номер текущей страницы на кнопке уменьшится на 1. А если текущая страница первая, то ничего не изменится
            
            ![](https://ucarecdn.com/0788e97b-661e-427a-9122-143c3bf90db0/)
            
6.  Пользователь отправляет в чат команду /continue:
    1.  Бот отправляет в чат страницу книги, на которой пользователь остановил чтение во время последнего взаимодействия с сообщением-книгой.
    2.  Если пользователь еще не начинал читать книгу - бот отправляет сообщение с первой страницей книги
7.  Пользователь отправляет в чат команду /bookmarks:
    1.  Если пользователь сохранял закладки ранее, то бот отправляет в чат список сохраненных закладок в виде инлайн-кнопок, а также инлайн-кнопки "Редактировать" и "Отменить"
        
        ![](https://ucarecdn.com/b139009f-0fba-4624-8d47-198bd7beec79/-/preview/-/enhance/86/)
        
        1.  Если пользователь нажимает на кнопку с закладкой - бот отправляет сообщение с книгой на той странице, куда указывала закладка
        2.  Если пользователь нажимает на кнопку "Отменить", то бот убирает список закладок и отправляет сообщение с предложением продолжить чтение, отправив команду /continue
            
            ![](https://ucarecdn.com/774766d2-5759-4913-a4ac-e32a9508d400/-/preview/-/enhance/87/)
            
        3.  Если пользователь нажимает на кнопку "Редактировать", то бот отправляет список сохраненных закладок в виде инлайн-кнопок с пометкой на удаление, а также инлайн-кнопку "Отменить"
            
            ![](https://ucarecdn.com/471384ca-b55b-4a6b-8a2a-24d473d717dd/-/preview/-/enhance/83/)
            
            1.  Если пользователь нажимает на закладку с пометкой на удаление - она пропадает из списка редактируемых закладок
            2.  Если список содержит хотя бы одну закладку и пользователь нажимает "Отменить" - бот убирает сообщение со списком редактируемых закладок и меняет его на сообщение с предложением продолжить чтение, отправив команду /continue
                
                ![](https://ucarecdn.com/774766d2-5759-4913-a4ac-e32a9508d400/-/preview/-/enhance/87/)
                
            3.  Если в списке, после очередного удаления закладки, не остается ни одной закладки - бот сообщает пользователю, что у него нет ни одной закладки и предлагает продолжить чтение книги, отправив команду /continue
                
                ![](https://ucarecdn.com/edcdd845-7887-4979-9453-263cf1ec339e/-/preview/-/enhance/87/)
                
8.  Пользователь отправляет в чат любое другое сообщение:
    1.  Бот как-то реагирует на такое сообщение, например, эхом