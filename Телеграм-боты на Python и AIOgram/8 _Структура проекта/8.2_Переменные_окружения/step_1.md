## Переменные окружения
--------------------

Прежде чем поговорить о шаблоне бота, давайте разберемся с тем, где хранить секреты проекта. Под секретами будем понимать следующие данные:

*   API-токен бота
*   Пароли доступа к внешним сервисам
*   API-ключи
*   Ключи от платежных систем
*   ...

То есть это те данные, потеря которых может повлечь за собой негативные последствия для вас или проекта.

Я уже несколько раз упоминал, что хардкодить чувствительные данные прямо в исполняемом коде - это плохая практика как с точки зрения безопасности, так и с точки зрения удобства. Небезопасно это потому, что есть не нулевая вероятность того, что когда вы захотите поделиться своим кодом - вы забудете вычистить из него чувствительные данные, и это потенциально может вам навредить. А неудобно, потому что ключи могут требоваться в разных частях программы, а где и какие - можно забыть и долго искать, в случае необходимости изменить.

Пока, в программах, что мы уже писали, API-токен бота мы хранили прямо в исполняемом файле.

    BOT_TOKEN: str = '5424991242:AAGwomxQz1p46bRi_2m3V7kvJlt5RjK9xr0'

Это было исключительно в учебных целях, чтобы не усложнять повествование и сосредоточиться на тех аспектах урока, которые мы тогда разбирали. Дальше, мы так делать почти не будем, а если будем, то опять же для скорости, но с постоянным удержанием в голове мысли, что так делать неправильно.

Следующий способ хранить секреты - это завести для этого отдельный модуль, хранить все секреты в нем и импортировать их по мере необходимости. Плюс такого метода в том, что так все ключи находятся в одном месте и ими легко управлять, а минус в том, что их нельзя прокинуть из каких-то внешних сервисов администрирования, докера и т.п. Кроме того, такой файл должен храниться в репозитории как часть проекта, потому что импорты из него будут прописаны по другим модулям проекта. Конечно, из этой ситуации есть выход - можно добавить такой файл в `.gitignore`, но лучшим подходом считается не хранить секреты в таком файле, а загружать их в этот файл снаружи, из окружения, внутри которого проект запускается, загрузив их, перед этим, в это самое окружение. Можете думать об этом как о некоторых переменных в глобальной области видимости, но не на уровне интерпретатора, а на уровне той среды, в которой запущен интерпретатор.

Из интерпретатора получить доступ к переменным окружения можно с помощью библиотеки `os` и ее метода `getenv()`.

    import os
    
    
    print(os.getenv('<имя_переменной>'))

Но сначала переменную нужно загрузить в окружение. В разных системах и терминалах это делается по-разному.

### MacOS и Linux:

    export <имя_переменной>=<значение_переменной>

### Powershell Windows:

    $Env:<имя_переменной>=<значение_переменной>

Давайте создадим переменную окружения с токеном нашего бота (не забудьте мой токен заменить на ваш).

### MacOS и Linux:

    export BOT_TOKEN=5424991242:AAGwomxQz1p46bRi_2m3V7kvJlt5RjK9xr0

### Powershell Windows:

    $Env:BOT_TOKEN=5424991242:AAGwomxQz1p46bRi_2m3V7kvJlt5RjK9xr0

А чтобы убедиться, что такая переменная теперь есть в окружении, там же в терминале нужно выполнить команду:

### MacOS и Linux:

    echo $BOT_TOKEN

### Powershell Windows:

    echo $Env:BOT_TOKEN

В ответ вы должны получить значение переменной `BOT_TOKEN`, которую до этого загрузили в окружение:

    5424991242:AAGwomxQz1p46bRi_2m3V7kvJlt5RjK9xr0

Ну, и убедившись, что такая переменная теперь есть, давайте получим к ней доступ внутри скрипта Python, выполнив код:

    import os
    
    
    print(os.getenv('BOT_TOKEN'))

Если все пройдет как надо, вы получите ответ в терминале с токеном вашего бота:

    5424991242:AAGwomxQz1p46bRi_2m3V7kvJlt5RjK9xr0

Возникает резонный вопрос. А как загружать переменные окружения, прошу прощения за тавтологию, в окружение? Для разных случаев управления ботом, используют разные способы загрузки переменных окружения в, прошу прощения за тавтологию еще раз, окружение. Ну, не вручную же каждый раз через `export`. Сейчас я расскажу про один из таких способов.