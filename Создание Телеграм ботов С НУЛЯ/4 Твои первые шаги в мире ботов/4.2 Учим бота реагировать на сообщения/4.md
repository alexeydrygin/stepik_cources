А сегодня мы приступаем к изучению конкретных handler'ов. Если забыл, то напомню, что это декораторы, которые ловят определенные сообщения или другие апдейты от пользователя. Вернёмся к нашему прошлому примеру

```python
    @dp.message()
    async def echo_handler(message: types.Message) -> None:
        await message.send_copy(chat_id=message.chat.id)
```

Нас сейчас не волнуют никакие строчки кроме как первой, именно она отвечает за то, что попадет уже в саму функцию. Предлагаю сейчас рассмотреть её поподробнее. Абсолютно все handler'ы наследуются от ранее определенного нами объекта dp, и после уже указывается, что именно мы хотим принимать. Чаще всего ты будешь сталкиваться с двумя видами: message и callback\_query, где первый отвечает за приём сообщений, а второй за обработку нажатий inline-кнопок (кнопки, которые "прилипают" к сообщению). 

А теперь к сути. В aiogram3 сильно изменили регистрацию, и теперь осталось всего 2 варианта, что может быть внутри скобок, начнём с самого лёгкого
```python
    from aiogram.filters import Command
    
    
    @dp.message(Command('name'))
    async def echo_handler(message: types.Message) -> None:
        await message.send_copy(chat_id=message.chat.id)
```
Для обработки команд нам потребуется сделать ещё один импорт, а также прописать такую незамысловатую конструкцию внутри скобок. Теперь наш handler будет принимать на вход только команду /name (а также аргумент, например /name Андрей). Тут не так много тонкостей, но есть одна интересная - команды можно передать списком, и он будет реагировать на каждую из них.

**А ещё очень важный момент. ОЧЕНЬ ВАЖНЫЙ: можно навесить много handler'ов на одну функцию, будет выглядеть это так.**
```python
    from aiogram.filters import Command
    
    
    @dp.message(Command('name1'))
    @dp.message(Command('name2'))
    @dp.message(Command('name'))
    async def echo_handler(message: types.Message) -> None:
        await message.send_copy(chat_id=message.chat.id)
```
С командами мы разобрались, а теперь приступим к ловле обычных сообщений от пользователя, это уже будет выглядеть следующим образом
```python
    from aiogram import F
    
    @dp.message(F.text == "Меню"))
    async def echo_handler(message: types.Message) -> None:
        await message.send_copy(chat_id=message.chat.id)
```
Здесь мы уже знакомимся с новым импортом - магические фильтры. Мне тяжело объяснить, почему они так называются, но всё, что остаётся, это поверить в существование магии.

![](https://ucarecdn.com/b6c92d2d-e1be-4d6b-8096-d50e54b8cc2b/)

Как можно заметить, они работают как обычное условие в python. И работают они по булевому принципу, если условие внутри скобок будет равно True, то handler приступит к обработке, если нет, то соответственно и нет. На самом деле это открывает очень большие перспективы для разработки. Например, можно вытворять что-нибудь такое:
```python
    @dp.message(F.text.startswith("яблоко")))
```    

Теперь наш handler будет принимать абсолютно все сообщения, которые начинаются с "яблоко".